datasource db {
  provider = "mysql"
}

generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

model User {
  id            Int       @id @default(autoincrement())
  uuid          String    @unique @default(uuid())
  email         String    @unique
  name          String?
  username      String?   @unique
  dateOfBirth   DateTime?
  avatar        String?
  classGrade    String?
  mobile_prefix String    @default("+91")
  mobile        String?
  about         String?   @db.Text
  password      String
  status        Boolean   @default(true)
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt
  roles         Role[]    @relation("userroles")

  @@map("users")
}

model Role {
  id          Int          @id @default(autoincrement())
  name        String       @unique
  description String
  slug        String       @unique
  status      Boolean      @default(true)
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt
  permissions Permission[] @relation("rolepermissions")
  users       User[]       @relation("userroles")

  @@map("roles")
}

model Permission {
  id          Int      @id @default(autoincrement())
  name        String   @unique
  description String
  slug        String   @unique
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  roles       Role[]   @relation("rolepermissions")

  @@map("permissions")
}

model UserOtp {
  id             Int      @id @default(autoincrement())
  type           OtpType  @default(mobile)
  email          String?  @unique
  mobilePrefix   String?
  mobile         String?  @unique
  code           String   @db.VarChar(20)
  resend         Int      @default(0)
  failedAttempts Int      @default(0)
  expiresAt      DateTime
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt

  @@map("user_otps")
}

enum OtpType {
  email
  mobile
}
